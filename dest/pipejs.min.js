!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):window.Pipe=t()}(function(){"use strict";function t(o,e){(0,o._handler)(e,function(n){e=n||e,o._next?t(o._next,e):o._root.status=r},function(){})}function o(t){var e=this;return this instanceof o?(e._previous=null,e._next=null,e._handler=t,e._root={status:r,root:e}):e=new o(t),e}var r="idle";return o.prototype={constructor:o,source:function(o){if(this._root.status!==r)throw new Error;t(this._root.root,o)},remove:function(){this._root={status:r,root:this};var t=this._next,o=this._previous;t&&o?(t._previous=o,o._next=t):!t&&o?o._next=null:!o&&t&&(t._previous=null,t._root.root=t)},before:function(t){if(t._next)throw new Error;t._next=this,t._previous=this._previous,this._previous=t,t._root=this._root,t._previous||(t._root.root=t)},after:function(t){if(t._previous)throw new Error;t._previous=this,t._next=this._next,this._next=t,t._root=this._root}},o});